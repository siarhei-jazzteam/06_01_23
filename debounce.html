<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

    <!-- –£ —Ñ–æ—Ä–º—ã –µ—Å—Ç—å –∞—Ç—Ä–∏–±—É—Ç action, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å,
        –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –æ—Ç–∫–ª—é—á–∏–ª–∏ —Å–∫—Ä–∏–ø—Ç—ã. -->
    <form action="/some-route" method="GET" id="search">
        <label>–ù–∞–π–¥–∏ –ª—é–±–∏–º—É—é –ø–∏—Ü—Ü—É:</label>
    
        <!-- –ò—Å–ø–æ–ª—å–∑—É–µ–º input —Å —Ç–∏–ø–æ–º search,
          —á—Ç–æ–±—ã –±—Ä–∞—É–∑–µ—Ä—ã –¥–µ–ª–∞–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –º–∞–≥–∏—é
          —Å –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∏ –ø–æ–¥—Ö–æ–¥—è—â–∏–º–∏ –∫–Ω–æ–ø–∫–∞–º–∏
          –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã—Ö –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞—Ö. -->
        <input type="search" name="query" placeholder="–ú–∞—Ä–≥–∞—Ä–∏—Ç–∞" />
    
    <ul class="search-results"></ul>

    <script>

        const pizzaList = [
                '–ú–∞—Ä–≥–∞—Ä–∏—Ç–∞',
                '–ü–µ–ø–ø–µ—Ä–æ–Ω–∏',
                '–ì–∞–≤–∞–π—Å–∫–∞—è',
                '4 –°—ã—Ä–∞',
                '–î–∏–∞–±–ª–æ',
                '–°–∏—Ü–∏–ª–∏–π—Å–∫–∞—è'
            ];

            // –í —Ñ—É–Ω–∫—Ü–∏–∏ contains –º—ã –±—É–¥–µ–º –ø—Ä–æ–≤–µ—Ä—è—Ç—å,
                // —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∑–∞–ø—Ä–æ—Å
                // –≤ –∫–∞–∫–æ–º-–ª–∏–±–æ –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏–π:
            function contains(query) {
                return pizzaList.filter((title) =>
                    title.toLowerCase().includes(query.toLowerCase())
                );
            }

            const server = {
                    search(query) {
                        // –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –ø—Ä–æ–º–∏—Å,
                        // —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º—ã –±—É–¥–µ–º —ç–º—É–ª–∏—Ä–æ–≤–∞—Ç—å ¬´–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å¬ª,
                        // –∫–∞–∫ –±—É–¥—Ç–æ –º—ã ¬´—Å—Ö–æ–¥–∏–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –æ–Ω –ø–æ–¥—É–º–∞–ª –∏ –æ—Ç–≤–µ—Ç–∏–ª¬ª.
                        console.log('query');
                        return new Promise((resolve) => {
                            // –¢–∞–π–º–∞—É—Ç –Ω—É–∂–µ–Ω –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ç–æ–≥–æ,
                            // —á—Ç–æ–±—ã –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –≤—Ä–µ–º—è –∑–∞–¥–µ—Ä–∂–∫–∏ üôÇ
                            setTimeout(
                                () =>
                                    resolve({
                                        // –í –∫–∞—á–µ—Å—Ç–≤–µ –æ—Ç–≤–µ—Ç–∞ –±—É–¥–µ–º –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –æ–±—ä–µ–∫—Ç,
                                        // –∑–Ω–∞—á–µ–Ω–∏–µ–º –ø–æ–ª—è list –∫–æ—Ç–æ—Ä–æ–≥–æ
                                        // –±—É–¥–µ—Ç –Ω–∞—à –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤.
                                        list: query ? contains(query) : [],
                                    }),
                                150
                            );
                        });
                    },
                };

            const searchForm = document.querySelector('#search');
            const searchInput = searchForm.querySelector('[type="search"]');
            const searchResults = document.querySelector(".search-results");

            
            function handleInput(e) {
                    const { value } = e.target;

                    server.search(value).then(function (response) {
                        const { list } = response;

                        const html = list.reduce((markup, item) => {
                            return `${markup}<li>${item}</li>`;
                        }, ``);
                        
                        searchResults.innerHTML = html;
                });
            }
                
                
            function debounce(callee, timeoutMs) {
                let lastCall;
                let lastCallTimer;
                return function perform(...args) {           
                    let previousCall = lastCall;           
                    lastCall = Date.now();
                    
                    if (previousCall && lastCall - previousCall <= timeoutMs) {
                        clearTimeout(lastCallTimer);
                        }
                            
                    lastCallTimer = setTimeout(() => callee(...args), timeoutMs);
                };
            }

            const debouncedHandle = debounce(handleInput, 500);
            
            searchInput.addEventListener("input", debouncedHandle);
                
    </script>

    
</body>
</html>